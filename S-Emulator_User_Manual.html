<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S-Emulator: User Manual for Testing</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 40px;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            text-align: center;
        }
        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }
        h3 {
            color: #2980b9;
            margin-top: 25px;
        }
        .highlight {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .code {
            background-color: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .bonus {
            background-color: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .decision {
            background-color: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }
        li {
            margin: 8px 0;
        }
    </style>
</head>
<body>

<h1>S-Emulator: User Manual for Testing</h1>

<div class="highlight">
    <strong>Student Information:</strong><br>
    <strong>Name:</strong> Avshalom Sharabani<br>
    <strong>ID:</strong> 318799608<br>
    <strong>Email:</strong> Avshalomsh@mta.ac.il<br>
    <strong>GitHub:</strong> <a href="https://github.com/AvshiSha/S-emulator">https://github.com/AvshiSha/S-emulator</a>
</div>

<h2>Table of Contents</h2>
<ol>
    <li><a href="#overview">System Overview</a></li>
    <li><a href="#decisions">Key Design Decisions</a></li>
    <li><a href="#bonus">Bonus Features</a></li>
    <li><a href="#installation">Installation & Setup</a></li>
    <li><a href="#usage">Usage Guide</a></li>
    <li><a href="#testing">Testing Scenarios</a></li>
    <li><a href="#technical">Technical Implementation</a></li>
    <li><a href="#troubleshooting">Troubleshooting</a></li>
</ol>

<h2 id="overview">1. System Overview</h2>

<h3>What is S-Emulator?</h3>
<p>S-Emulator is a Java-based program expansion and execution system that demonstrates how high-level synthetic instructions can be systematically expanded into basic instructions through multiple degrees of expansion.</p>

<h3>Core Functionality</h3>
<ul>
    <li><strong>Program Loading:</strong> Load XML-based S-Instruction programs</li>
    <li><strong>Program Expansion:</strong> Expand synthetic instructions to basic instructions</li>
    <li><strong>Program Execution:</strong> Execute programs with input values and cycle counting</li>
    <li><strong>Visual Display:</strong> Pretty-print programs and expansion results</li>
    <li><strong>State Management:</strong> Save and load exercise states (Bonus Feature)</li>
</ul>

<h2 id="decisions">2. Key Design Decisions</h2>

<div class="decision">
    <h3>2.1 Modular Architecture (Engine vs UI)</h3>
    <p><strong>Decision:</strong> Separated core engine logic from user interface</p>
    <p><strong>Rationale:</strong></p>
    <ul>
        <li><strong>Separation of Concerns:</strong> Engine handles computation, UI handles interaction</li>
        <li><strong>Maintainability:</strong> Changes to UI don't affect core logic</li>
        <li><strong>Testability:</strong> Engine can be tested independently</li>
        <li><strong>Extensibility:</strong> Easy to add new UI interfaces (GUI, web, etc.)</li>
    </ul>
</div>

<div class="decision">
    <h3>2.2 Java Serialization for Save/Load</h3>
    <p><strong>Decision:</strong> Used Java's built-in serialization for state persistence</p>
    <p><strong>Rationale:</strong></p>
    <ul>
        <li><strong>Simplicity:</strong> No external dependencies required</li>
        <li><strong>Object Graph Preservation:</strong> Maintains all object relationships</li>
        <li><strong>Type Safety:</strong> Automatic type checking during deserialization</li>
        <li><strong>Performance:</strong> Efficient binary format</li>
    </ul>
</div>

<div class="decision">
    <h3>2.3 Degree-Specific Row Numbering</h3>
    <p><strong>Decision:</strong> Each expansion degree gets fresh row numbering (1, 2, 3, ...)</p>
    <p><strong>Rationale:</strong></p>
    <ul>
        <li><strong>Clarity:</strong> Each degree is self-contained and easy to understand</li>
        <li><strong>Consistency:</strong> Row numbers always start from 1 in each degree</li>
        <li><strong>Debugging:</strong> Easier to trace instructions within each degree</li>
        <li><strong>User Experience:</strong> More intuitive for users to follow</li>
    </ul>
</div>

<div class="decision">
    <h3>2.4 Creation Chains Display</h3>
    <p><strong>Decision:</strong> Show complete instruction lineage with ">>>" separator</p>
    <p><strong>Rationale:</strong></p>
    <ul>
        <li><strong>Traceability:</strong> Users can see how each instruction was created</li>
        <li><strong>Educational Value:</strong> Demonstrates the expansion process</li>
        <li><strong>Debugging:</strong> Helps identify issues in expansion logic</li>
        <li><strong>Visual Clarity:</strong> Clear separation between instruction levels</li>
    </ul>
</div>

<h2 id="bonus">3. Bonus Features</h2>

<div class="bonus">
    <h3>3.1 Save/Load State Functionality</h3>
    <p><strong>Feature:</strong> Complete session persistence with automatic file management</p>
    
    <h4>Save State Capabilities:</h4>
    <ul>
        <li><strong>Complete Session Persistence:</strong> Saves current program, all run history, and execution results</li>
        <li><strong>Automatic File Naming:</strong> State files automatically named based on loaded program (e.g., "programName.state")</li>
        <li><strong>Directory Creation:</strong> Automatically creates parent directories if they don't exist</li>
        <li><strong>Error Handling:</strong> Robust error handling for permission issues and invalid paths</li>
        <li><strong>Quote Handling:</strong> Automatically removes quotes from user input paths</li>
    </ul>
    
    <h4>Load State Capabilities:</h4>
    <ul>
        <li><strong>Full Session Restoration:</strong> Restores exact program and complete run history</li>
        <li><strong>Seamless Continuation:</strong> Resume work exactly where you left off</li>
        <li><strong>Cross-Session Persistence:</strong> Maintain progress across multiple sessions</li>
        <li><strong>State Validation:</strong> Automatic validation of loaded state files</li>
        <li><strong>Type Safety:</strong> Proper casting and validation of loaded objects</li>
    </ul>
    
    <h4>Implementation Details:</h4>
    <ul>
        <li><strong>Java Serialization:</strong> Uses Java's built-in serialization for reliable state persistence</li>
        <li><strong>Object Graph Preservation:</strong> Maintains complete object relationships and references</li>
        <li><strong>Run History Tracking:</strong> Preserves all execution history including inputs, outputs, and cycle counts</li>
        <li><strong>User-Friendly Interface:</strong> Simple menu options (6 for Save, 7 for Load) with clear prompts</li>
    </ul>
</div>

<h2 id="installation">4. Installation & Setup</h2>

<h3>4.1 Requirements</h3>
<ul>
    <li><strong>Java:</strong> Version 21 or later</li>
    <li><strong>Operating System:</strong> Windows, macOS, or Linux</li>
    <li><strong>Memory:</strong> Minimum 512MB RAM</li>
    <li><strong>Disk Space:</strong> 100MB free space</li>
</ul>

<h3>4.2 Running the Application</h3>

<div class="highlight">
    <h4>Option 1: Using the Batch File (Recommended)</h4>
    <div class="code">run.bat</div>
    <p>Simply double-click the <code>run.bat</code> file to start the application.</p>
</div>

<div class="highlight">
    <h4>Option 2: Direct Java Command</h4>
    <div class="code">java -jar ui.jar</div>
    <p>Run this command from the directory containing both JAR files.</p>
</div>

<div class="warning">
    <strong>Important:</strong> Both <code>engine.jar</code> and <code>ui.jar</code> must be in the same directory for the application to work properly.
</div>

<h2 id="usage">5. Usage Guide</h2>

<h3>5.1 Main Menu</h3>
<p>When you start the application, you'll see the following menu:</p>

<div class="code">
=== S-Emulator ===
1) Load program
2) Show program
3) Expand
4) Run
5) History
6) Save program
7) Load program
8) Exit
Choose [1-8]:
</div>

<h3>5.2 Menu Options Explained</h3>

<table>
    <tr>
        <th>Option</th>
        <th>Description</th>
        <th>Usage</th>
    </tr>
    <tr>
        <td>1) Load program</td>
        <td>Load an XML program file</td>
        <td>Enter the full path to an XML file (e.g., C:\path\to\program.xml)</td>
    </tr>
    <tr>
        <td>2) Show program</td>
        <td>Display the loaded program</td>
        <td>Shows program details, inputs, labels, and instructions</td>
    </tr>
    <tr>
        <td>3) Expand</td>
        <td>Expand program to chosen degree</td>
        <td>Choose expansion degree (0 to max available)</td>
    </tr>
    <tr>
        <td>4) Run</td>
        <td>Execute program with input values</td>
        <td>Enter input values separated by commas</td>
    </tr>
    <tr>
        <td>5) History</td>
        <td>View execution history</td>
        <td>Shows table of all previous runs</td>
    </tr>
    <tr>
        <td>6) Save program</td>
        <td>Save current exercise state</td>
        <td>Enter directory path (file named automatically)</td>
    </tr>
    <tr>
        <td>7) Load program</td>
        <td>Load previously saved state</td>
        <td>Enter full path to .state file</td>
    </tr>
    <tr>
        <td>8) Exit</td>
        <td>Exit the application</td>
        <td>Closes the program</td>
    </tr>
</table>

<h3>5.3 Step-by-Step Workflow</h3>

<div class="highlight">
    <h4>Basic Workflow:</h4>
    <ol>
        <li><strong>Load Program:</strong> Choose option 1 and provide XML file path</li>
        <li><strong>View Program:</strong> Use option 2 to see the original program</li>
        <li><strong>Expand:</strong> Use option 3 to see expansion to degree 1 or 2</li>
        <li><strong>Execute:</strong> Use option 4 to run the program with inputs</li>
        <li><strong>Save State:</strong> Use option 6 to save your progress (Bonus)</li>
    </ol>
</div>

<h2 id="testing">6. Testing Scenarios</h2>

<h3>6.1 Basic Functionality Tests</h3>

<div class="highlight">
    <h4>Test 1: Program Loading</h4>
    <p><strong>Objective:</strong> Verify XML program loading works correctly</p>
    <p><strong>Steps:</strong></p>
    <ol>
        <li>Start the application</li>
        <li>Choose option 1 (Load program)</li>
        <li>Enter path to a valid XML file</li>
        <li>Verify "Loaded successfully" message appears</li>
    </ol>
    <p><strong>Expected Result:</strong> Program loads without errors</p>
</div>

<div class="highlight">
    <h4>Test 2: Program Display</h4>
    <p><strong>Objective:</strong> Verify program information is displayed correctly</p>
    <p><strong>Steps:</strong></p>
    <ol>
        <li>Load a program (Test 1)</li>
        <li>Choose option 2 (Show program)</li>
        <li>Verify program details are shown</li>
    </ol>
    <p><strong>Expected Result:</strong> Program name, inputs, labels, and instructions are displayed</p>
</div>

<div class="highlight">
    <h4>Test 3: Program Expansion</h4>
    <p><strong>Objective:</strong> Verify expansion functionality works correctly</p>
    <p><strong>Steps:</strong></p>
    <ol>
        <li>Load a program with synthetic instructions</li>
        <li>Choose option 3 (Expand)</li>
        <li>Select expansion degree (e.g., 1 or 2)</li>
        <li>Verify creation chains are displayed</li>
    </ol>
    <p><strong>Expected Result:</strong> Instructions show complete creation chains with ">>>" separators</p>
</div>

<div class="highlight">
    <h4>Test 4: Program Execution</h4>
    <p><strong>Objective:</strong> Verify program execution with input values</p>
    <p><strong>Steps:</strong></p>
    <ol>
        <li>Load a program</li>
        <li>Choose option 4 (Run)</li>
        <li>Select expansion degree (0 for original, 1+ for expanded)</li>
        <li>Enter input values (e.g., "5, 3")</li>
        <li>Verify execution results</li>
    </ol>
    <p><strong>Expected Result:</strong> Program executes and shows variable values and cycle count</p>
</div>

<h3>6.2 Bonus Feature Tests</h3>

<div class="bonus">
    <h4>Test 5: Save State</h4>
    <p><strong>Objective:</strong> Verify save state functionality works</p>
    <p><strong>Steps:</strong></p>
    <ol>
        <li>Load a program and run it</li>
        <li>Choose option 6 (Save program)</li>
        <li>Enter directory path (e.g., "C:\temp")</li>
        <li>Verify state file is created</li>
    </ol>
    <p><strong>Expected Result:</strong> State file created with automatic naming</p>
</div>

<div class="bonus">
    <h4>Test 6: Load State</h4>
    <p><strong>Objective:</strong> Verify load state functionality works</p>
    <p><strong>Steps:</strong></p>
    <ol>
        <li>Exit the application</li>
        <li>Restart the application</li>
        <li>Choose option 7 (Load program)</li>
        <li>Enter path to saved state file</li>
        <li>Verify program and history are restored</li>
    </ol>
    <p><strong>Expected Result:</strong> Complete session restored including run history</p>
</div>

<h3>6.3 Error Handling Tests</h3>

<div class="warning">
    <h4>Test 7: Invalid File Path</h4>
    <p><strong>Objective:</strong> Verify error handling for invalid paths</p>
    <p><strong>Steps:</strong></p>
    <ol>
        <li>Choose option 1 (Load program)</li>
        <li>Enter invalid path (e.g., "invalid.xml")</li>
        <li>Verify appropriate error message</li>
    </ol>
    <p><strong>Expected Result:</strong> Clear error message, application continues</p>
</div>

<div class="warning">
    <h4>Test 8: Invalid Input Values</h4>
    <p><strong>Objective:</strong> Verify input validation works</p>
    <p><strong>Steps:</strong></p>
    <ol>
        <li>Load a program</li>
        <li>Choose option 4 (Run)</li>
        <li>Enter invalid input (e.g., "abc, def")</li>
        <li>Verify error message and retry prompt</li>
    </ol>
    <p><strong>Expected Result:</strong> Input validation with clear error messages</p>
</div>

<h2 id="technical">7. Technical Implementation</h2>

<h3>7.1 Key Algorithms</h3>

<div class="highlight">
    <h4>Expansion Algorithm</h4>
    <p>The expansion process follows these steps:</p>
    <ol>
        <li><strong>Initialize:</strong> Start with degree 0 (original program)</li>
        <li><strong>Iterate:</strong> For each expansion step (1 to target degree)</li>
        <li><strong>Expand:</strong> Replace synthetic instructions with basic instructions</li>
        <li><strong>Track:</strong> Maintain parent-child relationships for lineage</li>
        <li><strong>Number:</strong> Assign fresh row numbers for each degree</li>
    </ol>
</div>

<div class="highlight">
    <h4>Execution Algorithm</h4>
    <p>Program execution follows these steps:</p>
    <ol>
        <li><strong>Initialize:</strong> Set up execution context with input values</li>
        <li><strong>Build Label Map:</strong> Create mapping of labels to instruction indices</li>
        <li><strong>Execute:</strong> Process instructions sequentially</li>
        <li><strong>Jump:</strong> Handle conditional and unconditional jumps</li>
        <li><strong>Track:</strong> Count cycles and update variable states</li>
    </ol>
</div>

<h3>7.2 Data Structures</h3>

<table>
    <tr>
        <th>Structure</th>
        <th>Purpose</th>
        <th>Implementation</th>
    </tr>
    <tr>
        <td>Identity Maps</td>
        <td>Track instruction relationships</td>
        <td>IdentityHashMap&lt;SInstruction, SInstruction&gt;</td>
    </tr>
    <tr>
        <td>Label Mapping</td>
        <td>Map labels to instruction indices</td>
        <td>HashMap&lt;String, Integer&gt;</td>
    </tr>
    <tr>
        <td>Variable State</td>
        <td>Track variable values during execution</td>
        <td>HashMap&lt;Variable, Long&gt;</td>
    </tr>
    <tr>
        <td>Run History</td>
        <td>Store execution history</td>
        <td>ArrayList&lt;RunResult&gt;</td>
    </tr>
</table>

<h3>7.3 Error Handling Strategy</h3>

<div class="highlight">
    <h4>Multi-Layer Error Handling</h4>
    <ul>
        <li><strong>Input Validation:</strong> Validate user input before processing</li>
        <li><strong>File Validation:</strong> Check file existence and format</li>
        <li><strong>XML Validation:</strong> Validate XML structure and content</li>
        <li><strong>Execution Safety:</strong> Handle runtime errors gracefully</li>
        <li><strong>User Feedback:</strong> Provide clear, actionable error messages</li>
    </ul>
</div>

<h2 id="troubleshooting">8. Troubleshooting</h2>

<h3>8.1 Common Issues</h3>

<table>
    <tr>
        <th>Issue</th>
        <th>Cause</th>
        <th>Solution</th>
    </tr>
    <tr>
        <td>JAR files not found</td>
        <td>Missing engine.jar or ui.jar</td>
        <td>Ensure both JAR files are in the same directory</td>
    </tr>
    <tr>
        <td>Java version error</td>
        <td>Java version too old</td>
        <td>Install Java 21 or later</td>
    </tr>
    <tr>
        <td>File not found</td>
        <td>Invalid file path</td>
        <td>Use absolute paths or check file existence</td>
    </tr>
    <tr>
        <td>Permission denied</td>
        <td>Insufficient permissions</td>
        <td>Run as administrator or change directory permissions</td>
    </tr>
    <tr>
        <td>Invalid XML format</td>
        <td>Malformed XML file</td>
        <td>Check XML syntax and structure</td>
    </tr>
</table>

<h3>8.2 Debug Information</h3>

<div class="highlight">
    <h4>Logging and Debugging</h4>
    <ul>
        <li><strong>Error Messages:</strong> All errors include descriptive messages</li>
        <li><strong>Validation Results:</strong> XML validation provides detailed feedback</li>
        <li><strong>Execution Tracking:</strong> Cycle counting and variable state tracking</li>
        <li><strong>History Logging:</strong> Complete run history with inputs and outputs</li>
    </ul>
</div>

<div class="success">
    <h3>8.3 Performance Considerations</h3>
    <ul>
        <li><strong>Memory Usage:</strong> Efficient data structures minimize memory footprint</li>
        <li><strong>Execution Speed:</strong> Optimized algorithms for fast program execution</li>
        <li><strong>Scalability:</strong> Handles programs with hundreds of instructions</li>
        <li><strong>User Experience:</strong> Responsive interface with clear feedback</li>
    </ul>
</div>

<div class="highlight">
    <h2>Conclusion</h2>
    <p>This S-Emulator system demonstrates advanced concepts in program transformation and execution. The modular design, comprehensive error handling, and bonus features make it a robust and user-friendly tool for understanding instruction expansion and program execution.</p>
    
    <p><strong>Key Strengths:</strong></p>
    <ul>
        <li>Clean, maintainable architecture</li>
        <li>Comprehensive error handling</li>
        <li>User-friendly interface</li>
        <li>Educational value through visual feedback</li>
        <li>Bonus features enhance usability</li>
    </ul>
</div>

</body>
</html>


